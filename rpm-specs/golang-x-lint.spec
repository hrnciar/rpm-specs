# Generated by go2rpm
%bcond_without check

# https://github.com/golang/lint
%global goipath         golang.org/x/lint
%global forgeurl        https://github.com/golang/lint
%global commit          738671d3881b9731cc63024d5d88cf28db875626

%gometa

%global goaltipaths     github.com/golang/lint

%global common_description %{expand:
Golint is a linter for Go source code.}

%global golicenses      LICENSE
%global godocs          CONTRIBUTING.md README.md

%global vimfiles_root %{_datadir}/vim/vimfiles

Name:           %{goname}
Version:        0
Release:        0.16%{?dist}
Summary:        Linter for Go source code

# Upstream license specification: BSD-3-Clause
License:        BSD
URL:            %{gourl}
Source0:        %{gosource}

BuildRequires:  golang(golang.org/x/tools/go/ast/astutil)
BuildRequires:  golang(golang.org/x/tools/go/gcexportdata)

Obsoletes:      golint < 0-0.11
Provides:       golint = %{version}-%{release}

%description
%{common_description}

%gopkg

%package -n vim-golint

Requires:       %name
Requires:       vim-common

Summary: Golint vim plugin
%description -n vim-golint
%summary

# TODO package emacsXXXX package the emacs plug-in

%prep
%goprep

%build
for cmd in golint; do
  %gobuild -o %{gobuilddir}/bin/$(basename $cmd) %{goipath}/$cmd
done

%install
%gopkginstall
install -m 0755 -vd                     %{buildroot}%{_bindir}
install -m 0755 -vp %{gobuilddir}/bin/* %{buildroot}%{_bindir}/

# vim plugin
mkdir -p %{buildroot}%{vimfiles_root}
cp -ar misc/vim/ftplugin %{buildroot}%{vimfiles_root}

%if %{with check}
%check
%gocheck
%endif

%files
%license LICENSE
%doc CONTRIBUTING.md README.md
%{_bindir}/*

%gopkgfiles

%files -n vim-golint
%{vimfiles_root}/ftplugin/*

%changelog
* Fri Aug 07 19:35:48 CEST 2020 Robert-André Mauchin <zebob.m@gmail.com> - 0-0.16.20200807git738671d
- Bump to commit 738671d3881b9731cc63024d5d88cf28db875626

* Tue Jul 28 2020 Fedora Release Engineering <releng@fedoraproject.org> - 0-0.15
- Rebuilt for https://fedoraproject.org/wiki/Fedora_33_Mass_Rebuild

* Fri Feb 07 00:24:01 CET 2020 Robert-André Mauchin <zebob.m@gmail.com> - 0-0.14.20200207git910be7a
- Bump to commit 910be7a94367618fd0fd25eaabbee4fdc0ac7092

* Wed Jan 29 2020 Fedora Release Engineering <releng@fedoraproject.org> - 0-0.13
- Rebuilt for https://fedoraproject.org/wiki/Fedora_32_Mass_Rebuild

* Thu Jul 25 2019 Fedora Release Engineering <releng@fedoraproject.org> - 0-0.12
- Rebuilt for https://fedoraproject.org/wiki/Fedora_31_Mass_Rebuild

* Wed Jul 10 2019 Elliott Sales de Andrade <quantum.analyst@gmail.com> - 0-0.11.20190625git959b441
- Restore vim plugin subpackage
- Add Obsoletes for old name

* Tue Jun 25 20:30:06 CEST 2019 Robert-André Mauchin <zebob.m@gmail.com> - 0-0.2.20190625git959b441
- Add Provides/Obsoletes

* Mon Apr 29 16:51:10 CEST 2019 Robert-André Mauchin <zebob.m@gmail.com> - 0-0.1.20190625git959b441
- Initial package
