# Generated by go2rpm 1
%bcond_without check

# https://github.com/kubernetes-sigs/kustomize/
%global goipath         sigs.k8s.io/kustomize
%global forgeurl        https://github.com/kubernetes-sigs/kustomize
Version:                0.8.1
%global tag             kyaml/v0.8.1
%global distprefix      %{nil}

%gometa

%global  __go_path  ^%{gopath}/src/.+/kyaml/.goipath

%global goname          golang-sigs-k8s-kustomize-kyaml
%global godevelname     golang-sigs-k8s-kustomize-kyaml-devel

%global common_description %{expand:
Customization of kubernetes YAML configurations.}

%global golicenses      LICENSE
%global godocs          docs examples CONTRIBUTING.md code-of-conduct.md\\\
                        README.md docs

Name:           %{goname}
Release:        1%{?dist}
Summary:        Customization of kubernetes YAML configurations

# Upstream license specification: Apache-2.0
License:        ASL 2.0

URL:            %{gourl}
Source0:        %{gosource}

BuildRequires:  golang(github.com/davecgh/go-spew/spew)
BuildRequires:  golang(github.com/go-errors/errors)
BuildRequires:  golang(github.com/go-openapi/spec)
BuildRequires:  golang(github.com/go-openapi/strfmt)
BuildRequires:  golang(github.com/go-openapi/validate)
BuildRequires:  golang(github.com/monochromegane/go-gitignore)
BuildRequires:  golang(github.com/qri-io/starlib/util)
BuildRequires:  golang(github.com/sergi/go-diff/diffmatchpatch)
BuildRequires:  golang(github.com/spf13/cobra)
BuildRequires:  golang(github.com/spf13/pflag)
BuildRequires:  golang(github.com/stretchr/testify/assert)
BuildRequires:  golang(github.com/xlab/treeprint)
BuildRequires:  golang(go.starlark.net/starlark)
BuildRequires:  golang(go.starlark.net/starlarkstruct)
BuildRequires:  golang(gopkg.in/yaml.v2)
BuildRequires:  golang(gopkg.in/yaml.v3)

%description
%{common_description}

%gopkg

%prep
%goprep
find . -mindepth 1 -maxdepth 1 -not -wholename './kyaml' -not -wholename './_build' -exec rm -rf {} +

%install
%gopkginstall
# Deal with conflicting .goipath with kustomize package
mv %{buildroot}%{gopath}/src/%{goipath}/.goipath %{buildroot}%{gopath}/src/%{goipath}/kyaml/.goipath
sed -i "/\.goipath/d" golang-sigs-k8s-kustomize-devel.file-list
echo "%{gopath}/src/%{goipath}/kyaml/.goipath" >> golang-sigs-k8s-kustomize-devel.file-list


%if %{with check}
%check
%gocheck -d kyaml/comments \
         -d kyaml/fix/fixsetters \
         -d kyaml/fn/runtime/runtimeutil \
         -d kyaml/fn/runtime/starlark \
         -d kyaml/kio \
         -d kyaml/setters2 \
         -d kyaml/yaml
%endif

%gopkgfiles

%changelog
* Tue Aug 18 04:24:00 CEST 2020 Robert-Andr√© Mauchin <zebob.m@gmail.com> - 3.8.1-1
- Initial package
